(function(A){A.widget("ui.spinner",{init:function(){var C=this;this.element.addClass("ui-spinner");this.element[0].value=this.options.start;var B=this.element.innerHeight()/2-parseInt(this.element.css("borderTopWidth"),10)-2;this.element.wrap("<div>").parent().css({position:this.element.css("position")=="static"?"relative":this.element.css("position"),left:this.element.css("left"),top:this.element.css("top"),width:this.element.outerWidth(),height:this.element.outerHeight()}).css("float",this.element.css("float")).prepend('<div class="ui-spinner-up"></div>').find("div.ui-spinner-up").bind("mousedown",function(){if(!C.counter){C.counter=1}C.mousedown(100,"up")}).bind("mouseup",function(D){C.counter=0;if(C.timer){window.clearInterval(C.timer)}C.element[0].focus();C.propagate("change",D)}).css({height:B,top:parseInt(this.element.css("borderTopWidth"),10)+1,right:parseInt(this.element.css("borderRightWidth"),10)+1}).end().append('<div class="ui-spinner-down"></div>').find("div.ui-spinner-down").bind("mousedown",function(){if(!C.counter){C.counter=1}C.mousedown(100,"down")}).bind("mouseup",function(D){C.counter=0;if(C.timer){window.clearInterval(C.timer)}C.element[0].focus();C.propagate("change",D)}).css({height:B,bottom:parseInt(this.element.css("borderBottomWidth"),10)+1,right:parseInt(this.element.css("borderRightWidth"),10)+1}).end();this.element.bind("keydown.spinner",function(D){if(!C.counter){C.counter=1}C.keydown.call(C,D)}).bind("keyup.spinner",function(D){C.counter=0;C.cleanUp();C.propagate("change",D)});if(A.fn.mousewheel){this.element.mousewheel(function(D,E){C.mousewheel(D,E)})}},plugins:{},constrain:function(){if(this.options.min!=undefined&&this.element[0].value<this.options.min){this.element[0].value=this.options.min}if(this.options.max!=undefined&&this.element[0].value>this.options.max){this.element[0].value=this.options.max}},cleanUp:function(){this.element[0].value=this.element[0].value.replace(/[^0-9\-]/g,"");this.constrain()},down:function(B){if(isNaN(parseInt(this.element[0].value,10))){this.element[0].value=this.options.start}this.element[0].value-=(this.options.incremental&&this.counter>100?(this.counter>200?100:10):1)*this.options.stepping;this.constrain();if(this.counter){this.counter++}this.propagate("spin",B)},up:function(B){if(isNaN(parseInt(this.element[0].value,10))){this.element[0].value=this.options.start}this.element[0].value=parseFloat(this.element[0].value)+(this.options.incremental&&this.counter>100?(this.counter>200?100:10):1)*this.options.stepping;this.constrain();if(this.counter){this.counter++}this.propagate("spin",B)},mousedown:function(C,D){var B=this;C=C||100;if(this.timer){window.clearInterval(this.timer)}this.timer=window.setInterval(function(){B[D]();if(B.counter>20){B.mousedown(20,D)}},C)},keydown:function(B){if(B.keyCode==38||B.keyCode==39){this.up(B)}if(B.keyCode==40||B.keyCode==37){this.down(B)}if(B.keyCode==36){this.element[0].value=this.options.min||this.options.start}if(B.keyCode==35&&this.options.max!=undefined){this.element[0].value=this.options.max}},mousewheel:function(B,C){C=(A.browser.opera?-C/Math.abs(C):C);C>0?this.up(B):this.down(B);B.preventDefault()},ui:function(B){return{instance:this,options:this.options,element:this.element}},propagate:function(C,B){A.ui.plugin.call(this,C,[B,this.ui()]);return this.element.triggerHandler(C=="spin"?C:"spin"+C,[B,this.ui()],this.options[C])},destroy:function(){if(!A.data(this.element[0],"spinner")){return }this.element.removeClass("ui-spinner ui-spinner-disabled").removeData("spinner").unbind(".spinner");if(A.fn.mousewheel){this.element.unmousewheel()}}});A.ui.spinner.defaults={stepping:1,start:0,incremental:true}})(jQuery)